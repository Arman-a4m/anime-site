{% extends "base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/catalog.css') }}">
{% endblock %}

{% block content %}
<section class="catalog">
    <h1>üìö –ö–∞—Ç–∞–ª–æ–≥ –∞–Ω–∏–º–µ</h1>

    <!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
    <form method="get" class="filters">
        <input type="text" name="q" placeholder="üîç –ü–æ–∏—Å–∫ –∞–Ω–∏–º–µ..." value="{{ request.args.get('q', '') }}">

        <select name="genre">
            <option value="">–í—Å–µ –∂–∞–Ω—Ä—ã</option>
            {% for g in genres %}
            <option value="{{ g }}" {% if request.args.get('genre') == g %}selected{% endif %}>{{ g }}</option>
            {% endfor %}
        </select>

        <select name="year">
            <option value="">–í—Å–µ –≥–æ–¥—ã</option>
            {% for y in years %}
            <option value="{{ y }}" {% if request.args.get('year') == y %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>

        <select name="status">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            {% for s in statuses %}
            <option value="{{ s }}" {% if request.args.get('status') == s %}selected{% endif %}>{{ s }}</option>
            {% endfor %}
        </select>

        <select name="studio">
            <option value="">–í—Å–µ —Å—Ç—É–¥–∏–∏</option>
            {% for st in studios %}
            <option value="{{ st }}" {% if request.args.get('studio') == st %}selected{% endif %}>{{ st }}</option>
            {% endfor %}
        </select>

        <button type="submit" class="btn">–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
    </form>

    <!-- –°–µ—Ç–∫–∞ –∞–Ω–∏–º–µ -->
    {% if anime %}
        <div class="catalog-grid">
            {% for a in anime %}
                <article class="catalog-item">
                    <div class="poster">
                        <img src="{{ a.poster|e }}" alt="{{ a.title|e }}">
                    </div>
                    <h2>{{ a.title|e }}</h2>
                    <p class="genres"><b>–ñ–∞–Ω—Ä—ã:</b> {{ a.genre|join(', ') }}</p>
                    <a href="{{ url_for('anime_page', title=a.title) }}" class="btn">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                </article>
            {% endfor %}
        </div>
    {% else %}
        <p class="empty">üòî –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.</p>
    {% endif %}
</section>
{% endblock %}
